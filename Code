# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(corrplot)

# Load the Swiss dataset
data(swiss)

# Display the first few rows of the dataset
head(swiss)

# Summary statistics of the dataset
summary(swiss)

# Check for missing values
missing_values <- colSums(is.na(swiss))
print("Missing Values:")
print(missing_values)

# Data preprocessing: Standardize variables for better comparison
standardized_data <- scale(swiss[, c("Fertility", "Agriculture", "Education", "Catholic", "Infant.Mortality")])

# Create a new dataframe with standardized variables
swiss_std <- as.data.frame(standardized_data)
names(swiss_std) <- c("Fertility_std", "Agriculture_std", "Education_std", "Catholic_std", "Infant_Mortality_std")

# Visualize the standardized variables
pairs(swiss_std, main = "Scatterplot Matrix of Standardized Variables")

# Visualize the relationship between Fertility and Agriculture with color-coded regions
ggplot(swiss, aes(x = Fertility, y = Agriculture, color = Region)) +
  geom_point() +
  labs(title = "Fertility vs. Agriculture by Region",
       x = "Fertility",
       y = "Agriculture")

# Analyze the correlation matrix of standardized variables
correlation_matrix <- cor(swiss_std)

# Visualize the correlation matrix
corrplot(correlation_matrix, method = "color")

# Perform a linear regression analysis
model <- lm(Infant.Mortality ~ Fertility + Agriculture + Education + Catholic, data = swiss)
summary(model)

# Visualize the regression results
par(mfrow=c(2,2))
plot(model)

# You can continue to add more analyses based on your specific health-related questions and dataset.
